<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>æ±ºæ¸ˆãƒšãƒ¼ã‚¸</title>
  <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; color: #333; }
    .card { border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 8px; }
    button { padding: 12px 20px; font-size: 16px; background-color: #06C755; color: white; border: none; border-radius: 5px; cursor: pointer; }
    button:active { background-color: #05a346; }
  </style>
</head>
<body>

<h2>æœˆè© ã‚¢ã‚ªã‚¤ã®ã‚·ãƒ§ãƒƒãƒ— ğŸŒ™</h2>

<div class="card">
  <h3>ğŸ”¹ å˜å“å•†å“</h3>
  <p>å ã„ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆ1å›ï¼‰</p>
  <p>ä¾¡æ ¼ï¼š500å††</p>
  <button onclick="buySingle()">å˜å“ã‚’è³¼å…¥</button>
</div>

<div class="card">
  <h3>ğŸ”¹ ã‚µãƒ–ã‚¹ã‚¯å•†å“</h3>
  <p>æ¯æ—¥ã®å ã„ï¼‹å®‰å¦ç¢ºèª</p>
  <p>ä¾¡æ ¼ï¼šæœˆé¡ 980å††</p>
  <button onclick="buySubscription()">ã‚µãƒ–ã‚¹ã‚¯ã«ç™»éŒ²</button>
</div>

<script>
// --- è¨­å®šé …ç›® ---
const LIFF_ID = "2008865871-ceuoxSzX"; 
const STRIPE_SINGLE_URL = "https://buy.stripe.com/test_5kQ28rgd16nVaD93sf1Nu04"; // å˜å“ç”¨ã®Stripeãƒªãƒ³ã‚¯
const STRIPE_SUBSCRIPTION_URL = "https://buy.stripe.com/test_9B63cv0e3fYvbHd2ob1Nu03"; // ã‚µãƒ–ã‚¹ã‚¯ç”¨ã®Stripeãƒªãƒ³ã‚¯

async function initLIFF() {
  try {
    await liff.init({ liffId: LIFF_ID });
    if (!liff.isLoggedIn()) {
      liff.login();
    }
  } catch (err) {
    console.error("LIFFã®åˆæœŸåŒ–ã«å¤±æ•—ã—ã¾ã—ãŸ", err);
  }
}

async function getLineUserId() {
  const profile = await liff.getProfile();
  return profile.userId;
}

async function buySingle() {
  const lineUserId = await getLineUserId();
  // client_reference_id ã®ã¿ã«çµã£ã¦ä»˜ä¸ã—ã¾ã™
  const finalUrl = `${STRIPE_SINGLE_URL}?client_reference_id=${encodeURIComponent(lineUserId)}`;
  window.location.href = finalUrl;
}

async function buySubscription() {
  const lineUserId = await getLineUserId();
  // ã‚µãƒ–ã‚¹ã‚¯ç”¨ãƒªãƒ³ã‚¯ã«ã‚‚åŒæ§˜ã« lineUserId ã‚’ä»˜ä¸ã—ã¾ã™
  const finalUrl = `${STRIPE_SUBSCRIPTION_URL}?client_reference_id=${encodeURIComponent(lineUserId)}`;
  window.location.href = finalUrl;
}

initLIFF();
</script>

</body>
</html>
